{% extends 'zooventory/base.html' %}

{% block title %}Species{% endblock %}

{% block content %}
<div class="container mt-4">

    <!-- HEADER -->
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2 class="fw-bold">Species</h2>

        <div>
            <a href="{% url 'uniqueanimal_search' %}" class="btn btn-primary">Add From API</a>
            <a href="{% url 'uniqueanimal_create' %}" class="btn btn-success">Add New Species</a>
        </div>
    </div>


    <!-- FILTER & SEARCH BAR -->
    <form method="GET" class="card p-3 shadow-sm mb-4" style="background-color: #f5f5dc;">
        <div class="row g-3">

            <!-- SEARCH -->
            <div class="col-md-4">
                <label class="fw-bold">Search by Name</label>
                <input type="text" name="search" class="form-control"
                       placeholder="Search..."
                       value="{{ search|default_if_none:'' }}">
            </div>

            <!-- SORT -->
            <div class="col-md-4">
                <label class="fw-bold">Sort</label>
                <select name="sort" class="form-select">
                    <option value="name_asc" {% if sort == "name_asc" %}selected{% endif %}>Name A–Z</option>
                    <option value="name_desc" {% if sort == "name_desc" %}selected{% endif %}>Name Z–A</option>
                </select>
            </div>

        </div>

        <div class="mt-3 text-end">
            <button class="btn btn-success">Apply Filters</button>
            <a href="{% url 'uniqueanimal_index' %}" class="btn btn-secondary">Reset</a>
        </div>
    </form>


    <!-- SPECIES TABLE -->
    {% if uniqueanimals %}
        <table class="table table-bordered table-striped shadow-sm">
            <thead class="table-success">
                <tr>
                    <th>Name</th>
                    <th>Scientific Name</th>
                    <th>Created By</th>
                    <th class="text-center">View</th>
                    <th class="text-center">Update</th>
                </tr>
            </thead>

            <tbody>
                {% for animal in uniqueanimals %}
                    <tr>
                        <td>{{ animal.name }}</td>
                        <td>{{ animal.scientific_name|default:"—" }}</td>
                        <td>{{ animal.owner|default:"API" }}</td>

                        <td class="text-center">
                            <a href="{% url 'uniqueanimal_info' animal.id %}"
                               class="btn btn-info btn-sm">Info</a>
                        </td>

                        <td class="text-center">
                            {% if animal.owner == request.user %}
                                <a href="{% url 'uniqueanimal_update' animal.id %}"
                                   class="btn btn-warning btn-sm">Update</a>
                            {% else %}
                                <span class="text-muted">Not Allowed</span>
                            {% endif %}
                        </td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>

    {% else %}
        <p class="text-muted">No species found.</p>
    {% endif %}

</div>
{% endblock %}
